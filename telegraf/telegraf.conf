[global_tags]
  location = "${SITE_ID}"

[agent]
  interval = "${POLL_INTERVAL_SECONDS}"
  flush_interval = "5s"
  hostname = "telegraf"

[[inputs.http]]
  interval = "5s"
  timeout = "10s"
  urls = ["http://172.16.2.4/data.json?type=INST"]
  data_format = "json_v2"

  [[inputs.http.json_v2]]
    measurement_name = "pac2200"
    timestamp_path = "INST_VALUES.LOCAL_TIME"
    timestamp_format = "RFC3339"
    timestamp_timezone = "Europe/Berlin"

    # Spannung
    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.V_L1.value"
      type = "float"
      rename = "V_L1"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.V_L2.value"
      type = "float"
      rename = "V_L2"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.V_L3.value"
      type = "float"
      rename = "V_L3"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.V_L12.value"
      type = "float"
      rename = "V_L12"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.V_L23.value"
      type = "float"
      rename = "V_L23"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.V_L31.value"
      type = "float"
      rename = "V_L31"

    # Strom
    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.I_L1.value"
      type = "float"
      rename = "I_L1"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.I_L2.value"
      type = "float"
      rename = "I_L2"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.I_L3.value"
      type = "float"
      rename = "I_L3"

    # Wirkleistung
    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.P_SUM.value"
      type = "float"
      rename = "P_SUM"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.P_L1.value"
      type = "float"
      rename = "P_L1"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.P_L2.value"
      type = "float"
      rename = "P_L2"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.P_L3.value"
      type = "float"
      rename = "P_L3"

    # Scheinleistung
    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.VA_SUM.value"
      type = "float"
      rename = "VA_SUM"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.VA_L1.value"
      type = "float"
      rename = "VA_L1"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.VA_L2.value"
      type = "float"
      rename = "VA_L2"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.VA_L3.value"
      type = "float"
      rename = "VA_L3"

    # Blindleistung (Q1)
    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.VARQ1_SUM.value"
      type = "float"
      rename = "VARQ1_SUM"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.VARQ1_L1.value"
      type = "float"
      rename = "VARQ1_L1"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.VARQ1_L2.value"
      type = "float"
      rename = "VARQ1_L2"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.VARQ1_L3.value"
      type = "float"
      rename = "VARQ1_L3"

    # Leistungsfaktor
    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.PF_SUM.value"
      type = "float"
      rename = "PF_SUM"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.PF_L1.value"
      type = "float"
      rename = "PF_L1"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.PF_L2.value"
      type = "float"
      rename = "PF_L2"

    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.PF_L3.value"
      type = "float"
      rename = "PF_L3"

    # Frequenz
    [[inputs.http.json_v2.field]]
      path = "INST_VALUES.FREQ.value"
      type = "float"
      rename = "FREQ"

[[inputs.http]]
  interval = "10s"
  timeout = "10s"
  urls = ["http://172.16.2.4/data.json?type=AVG1"]
  data_format = "json_v2"

  [[inputs.http.json_v2]]
    measurement_name = "pac2200_avg1"
    timestamp_path = "AVERAGE_VALUES.LOCAL_TIME"
    timestamp_format = "RFC3339"
    timestamp_timezone = "Europe/Berlin"

    # Spannung
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.V_L1.value"
      type = "float"
      rename = "V_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.V_L2.value"
      type = "float"
      rename = "V_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.V_L3.value"
      type = "float"
      rename = "V_L3"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.V_L12.value"
      type = "float"
      rename = "V_L12"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.V_L23.value"
      type = "float"
      rename = "V_L23"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.V_L31.value"
      type = "float"
      rename = "V_L31"

    # Strom
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.I_L1.value"
      type = "float"
      rename = "I_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.I_L2.value"
      type = "float"
      rename = "I_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.I_L3.value"
      type = "float"
      rename = "I_L3"

    # Wirkleistung
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.P_SUM.value"
      type = "float"
      rename = "P_SUM"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.P_L1.value"
      type = "float"
      rename = "P_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.P_L2.value"
      type = "float"
      rename = "P_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.P_L3.value"
      type = "float"
      rename = "P_L3"

    # Scheinleistung
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.VA_SUM.value"
      type = "float"
      rename = "VA_SUM"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.VA_L1.value"
      type = "float"
      rename = "VA_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.VA_L2.value"
      type = "float"
      rename = "VA_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.VA_L3.value"
      type = "float"
      rename = "VA_L3"

    # Blindleistung (Q1)
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.VARQ1_SUM.value"
      type = "float"
      rename = "VARQ1_SUM"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.VARQ1_L1.value"
      type = "float"
      rename = "VARQ1_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.VARQ1_L2.value"
      type = "float"
      rename = "VARQ1_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.VARQ1_L3.value"
      type = "float"
      rename = "VARQ1_L3"

    # Leistungsfaktor
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.PF_SUM.value"
      type = "float"
      rename = "PF_SUM"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.PF_L1.value"
      type = "float"
      rename = "PF_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.PF_L2.value"
      type = "float"
      rename = "PF_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.PF_L3.value"
      type = "float"
      rename = "PF_L3"

    # Frequenz
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE1.FREQ.value"
      type = "float"
      rename = "FREQ"

[[inputs.http]]
  interval = "900s"
  timeout = "30s"
  urls = ["http://172.16.2.4/data.json?type=AVG2"]
  data_format = "json_v2"

  [[inputs.http.json_v2]]
    measurement_name = "pac2200_avg2"
    timestamp_path = "AVERAGE_VALUES.LOCAL_TIME"
    timestamp_format = "RFC3339"
    timestamp_timezone = "Europe/Berlin"

    # Spannung
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.V_L1.value"
      type = "float"
      rename = "V_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.V_L2.value"
      type = "float"
      rename = "V_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.V_L3.value"
      type = "float"
      rename = "V_L3"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.V_L12.value"
      type = "float"
      rename = "V_L12"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.V_L23.value"
      type = "float"
      rename = "V_L23"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.V_L31.value"
      type = "float"
      rename = "V_L31"

    # Strom
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.I_L1.value"
      type = "float"
      rename = "I_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.I_L2.value"
      type = "float"
      rename = "I_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.I_L3.value"
      type = "float"
      rename = "I_L3"

    # Wirkleistung
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.P_SUM.value"
      type = "float"
      rename = "P_SUM"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.P_L1.value"
      type = "float"
      rename = "P_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.P_L2.value"
      type = "float"
      rename = "P_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.P_L3.value"
      type = "float"
      rename = "P_L3"

    # Scheinleistung
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.VA_SUM.value"
      type = "float"
      rename = "VA_SUM"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.VA_L1.value"
      type = "float"
      rename = "VA_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.VA_L2.value"
      type = "float"
      rename = "VA_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.VA_L3.value"
      type = "float"
      rename = "VA_L3"

    # Blindleistung (Q1)
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.VARQ1_SUM.value"
      type = "float"
      rename = "VARQ1_SUM"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.VARQ1_L1.value"
      type = "float"
      rename = "VARQ1_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.VARQ1_L2.value"
      type = "float"
      rename = "VARQ1_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.VARQ1_L3.value"
      type = "float"
      rename = "VARQ1_L3"

    # Leistungsfaktor
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.PF_SUM.value"
      type = "float"
      rename = "PF_SUM"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.PF_L1.value"
      type = "float"
      rename = "PF_L1"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.PF_L2.value"
      type = "float"
      rename = "PF_L2"

    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.PF_L3.value"
      type = "float"
      rename = "PF_L3"

    # Frequenz
    [[inputs.http.json_v2.field]]
      path = "AVERAGE_VALUES.STAGE2.FREQ.value"
      type = "float"
      rename = "FREQ"

[[inputs.http]]
  interval = "5s"
  timeout = "10s"
  urls = ["http://172.16.2.4/data.json?type=COUNTER"]
  data_format = "json_v2"

  [[inputs.http.json_v2]]
    measurement_name = "pac2200_counter"
    timestamp_path = "COUNTER.LOCAL_TIME"
    timestamp_format = "RFC3339"
    timestamp_timezone = "Europe/Berlin"

    [[inputs.http.json_v2.field]]
      path = "COUNTER.ACTIVE_ENERGY.IMPORT.T1.L1"
      type = "float"
      rename = "ACT_ENERGY_IMPORT_T1_L1"

    [[inputs.http.json_v2.field]]
      path = "COUNTER.ACTIVE_ENERGY.IMPORT.T1.L2"
      type = "float"
      rename = "ACT_ENERGY_IMPORT_T1_L2"

    [[inputs.http.json_v2.field]]
      path = "COUNTER.ACTIVE_ENERGY.IMPORT.T1.L3"
      type = "float"
      rename = "ACT_ENERGY_IMPORT_T1_L3"

    [[inputs.http.json_v2.field]]
      path = "COUNTER.ACTIVE_ENERGY.IMPORT.T1.total"
      type = "float"
      rename = "ACT_ENERGY_IMPORT_T1_TOTAL"

[[outputs.influxdb_v2]]
  urls = ["http://influxdb:8086"]
  token = "${INFLUXDB_TOKEN}"
  organization = "${INFLUXDB_ORG}"
  bucket = "${INFLUXDB_BUCKET}"

[[outputs.influxdb_v2]]
  urls = ["http://${CLOUD_INFLUX_HOST}:${CLOUD_INFLUX_PORT}"]
  token = "${CLOUD_INFLUX_TOKEN}"
  organization = "${CLOUD_INFLUX_ORG}"
  bucket = "${CLOUD_INFLUX_BUCKET}"
  flush_interval = "1m"
  timeout = "30s"